{"version":3,"file":"home.ssr.js","sources":["../../www/pages/Home.jsx","../../www/utils/i18n.jsx","../../www/containers/HomeContainer.jsx"],"sourcesContent":["/**\n * Index page content.\n *\n * @author jun.thong@me.com (Jun Thong)\n */\n\nimport React from 'react';\nimport PropTypes            from 'prop-types';\nimport { translate }        from 'react-i18next';\nimport wretch               from 'wretch';\n\n@translate(['commons', 'index'])\nexport default class Home extends React.Component {\n    static propTypes = {\n        t: PropTypes.func.isRequired\n    };\n\n    /**\n     * Override constructor to dÃ©fine a default local state.\n     * @constructor\n     * @param {Object} props\n     */\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            mail: '',\n            password: '',\n            isLoading: false,\n            hasError: false\n        };\n    }\n\n    /**\n     * Map actual inputs to local state.\n     * @param {SyntheticEvent} e\n     */\n    handleInputChange = (e) => {\n        this.setState({\n            [e.target.name]: e.target.value\n        });\n    };\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n        this.setState({\n            isLoading: true\n        });\n\n        await this.login();\n    };\n\n    login = () => {\n        const loginUrl = document.querySelector('#login').getAttribute('action');\n        const loginForm = {\n            mail: document.querySelector('input[name=\"mail\"]').value,\n            password: document.querySelector('input[name=\"password\"]').value\n        };\n\n        wretch(loginUrl)\n            .options({ credentials: 'same-origin' })\n            .formUrl(loginForm)\n            .post()\n            .error(400, () => {\n                this.setState({ hasError: true, isLoading: false });\n            })\n            .json(() => {\n                // TODO check for success.\n                location.href = '/w';\n            })\n            .catch(() => {\n                this.setState({ hasError: true, isLoading: false });\n            });\n    };\n\n    render(){\n        const { t } = this.props;\n\n        return (\n            <form id={'login'} action=\"/login\" method=\"POST\" noValidate  onSubmit={this.handleSubmit}>\n                <img src=\"http://via.placeholder.com/260x390\" width=\"260\" height=\"390\" alt=\"\"/>\n\n                {this.state.hasError &&\n                <div className=\"callout alert\">\n                    {t('callout:invalidLogin')}\n                </div>\n                }\n\n                <input\n                    type=\"email\"\n                    name=\"mail\"\n                    placeholder={t('index:mailPlaceholder')}\n                    onChange={this.handleInputChange}\n                    disabled={this.state.isLoading}\n                    className={`${this.state.hasError ? 'error' : ''}`}\n                    autoComplete=\"on\" />\n\n                <input\n                    type=\"password\"\n                    name=\"password\"\n                    placeholder={t('index:pwdPlaceholder')}\n                    onChange={this.handleInputChange}\n                    disabled={this.state.isLoading}\n                    className={`${this.state.hasError ? 'error' : ''}`}\n                    autoComplete=\"off\" />\n\n                <input\n                    type=\"submit\"\n                    value={t('index:submit')}\n                    disabled={this.state.isLoading} />\n            </form>\n        );\n    }\n}\n","/**\n * I18next configuration.\n *\n * @author jun.thong@me.com (Jun Thong)\n */\n\nimport i18next from 'i18next';\nimport commons from '../../../locales/fr/commons.json';\nimport home from '../../../locales/fr/home.json';\n\nconst locales = { commons, home };\n\nconst i18nCfg = {\n    lng: 'fr',\n    fallbackLng: 'fr',\n    debug: false,\n    ns: ['commons', 'home', 'nav'],\n    defaultNS: 'commons',\n\n    interpolation: {\n        escapeValue: false // not needed for react!!\n    },\n\n    // react i18next special options (optional)\n    react: {\n        wait: false,\n        nsMode: 'default'\n    },\n\n    resources: {\n        fr: locales\n    }\n};\n\ni18next.init(i18nCfg);\n\nexport { i18next as default };\n","/**\n * homepage component.\n *\n * @author jun.thong@me.com (Jun Thong)\n */\n\nimport React                        from 'react';\nimport Home                         from '../pages/Home.jsx';\nimport { I18nextProvider }          from 'react-i18next';\nimport i18n                         from '../utils/i18n.jsx';\n\nexport default class HomeContainer extends React.Component {\n    render(){\n        return (\n            <I18nextProvider i18n={i18n}>\n                <Home />\n            </I18nextProvider>\n        );\n    }\n}\n"],"names":["Home","translate","React","Component","props","handleInputChange","e","setState","target","name","value","handleSubmit","preventDefault","_this","login","loginUrl","document","querySelector","getAttribute","loginForm","options","credentials","formUrl","post","error","hasError","isLoading","json","href","catch","state","t","this","id","action","method","noValidate","onSubmit","src","width","height","alt","className","propTypes","PropTypes","func","isRequired","locales","commons","home","i18nCfg","i18next","init","HomeContainer","i18n"],"mappings":"goBAYqBA,WADpBC,wBAAW,UAAW,wCACWC,MAAMC,sBAUxBC,mBACFA,QAcVC,kBAAqBC,CAAAA,SACZC,WACAD,EAAEE,OAAOC,MAAOH,EAAEE,OAAOE,eAIlCC,kCAAe,UAAOL,KAChBM,mBACGL,qBACU,UAGTM,EAAKC,4DAGfA,MAAQ,YACEC,EAAWC,SAASC,cAAc,UAAUC,aAAa,UACzDC,QACIH,SAASC,cAAc,sBAAsBP,eACzCM,SAASC,cAAc,0BAA0BP,cAGxDK,GACFK,SAAUC,YAAa,gBACvBC,QAAQH,GACRI,OACAC,MAAM,IAAK,UACHjB,UAAWkB,UAAU,EAAMC,WAAW,MAE9CC,KAAK,cAEOC,KAAO,OAEnBC,MAAM,UACEtB,UAAWkB,UAAU,EAAMC,WAAW,aA9C9CI,YACK,YACI,cACC,YACD,kBA+CRC,EAAEA,GAAMC,KAAK5B,aAGfF,4BAAM+B,GAAI,QAASC,OAAO,SAASC,OAAO,OAAOC,cAAYC,SAAUL,KAAKrB,yCACnE2B,IAAI,qCAAqCC,MAAM,MAAMC,OAAO,MAAMC,IAAI,UAErEX,MAAML,UACZvB,2BAAKwC,UAAU,mBACR,2DAKE,aACA,mBACQX,EAAE,kCACLC,KAAK3B,2BACL2B,KAAKF,MAAMJ,uBACPM,KAAKF,MAAML,SAAW,QAAU,kBACjC,yCAGR,gBACA,uBACQM,EAAE,iCACLC,KAAK3B,2BACL2B,KAAKF,MAAMJ,uBACPM,KAAKF,MAAML,SAAW,QAAU,kBACjC,0CAGR,eACEM,EAAE,yBACCC,KAAKF,MAAMJ,uBAhG9BiB,aACAC,UAAUC,KAAKC,kGCJpBC,SAAYC,QAAAA,QAASC,KAAAA,MAErBC,aACG,iBACQ,YACN,MACF,UAAW,OAAQ,iBACb,sCAGM,gBAKP,SACE,yBAIJH,UAIZI,KAAQC,KAAKF,aCvBQG,4BAAsBnD,MAAMC,0BAGrCD,kDAAiBoD,KAAMA,0BAClBtD"}